<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>Malware Defender — Dual Joysticks</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <script>
  if(!localStorage.getItem("playerName")){
    window.location.href = "login.html";
  }
</script>


    <!-- FULLSCREEN BUTTON (always on top) -->
    <button id="fsBtn" class="fs-btn">⛶ Fullscreen</button>

    <!-- GAME CANVAS -->
    <canvas id="game" width="960" height="540"></canvas>

    <!-- MOBILE CONTROLS: dual joysticks -->
    <div id="mobile-controls" aria-hidden="true">
      <div id="joystick-left" class="joystick">
        <div id="stick-left" class="stick"></div>
      </div>

      <div id="joystick-right" class="joystick">
        <div id="stick-right" class="stick"></div>
      </div>
    </div>

    <!-- HUD -->
    <div class="hud">
      <div class="row">
        <div class="badge">Threats: <span id="score">0</span></div>
        <div class="badge">Time: <span id="time">0.0</span>s</div>
        <div class="badge">Integrity: <span id="hp">100</span>%</div>
        <div class="badge">Wave: <span id="wave">1</span></div>
        <div class="badge">Boss: <span id="boss">—</span></div>
      </div>
      <div class="help">
        Left joystick: Move • Right joystick: Aim & auto-shoot • R: Restart
      </div>
      <button id="startBtn" class="btn">Start</button>
    </div>
<!-- Firebase (add this before <script src="game.js"></script>) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
  import {
    getDatabase, ref, push, set, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

  // --- REPLACE/VERIFY THIS CONFIG (you pasted it already in console) ---
  const firebaseConfig = {
    apiKey: "AIzaSyA6MdK6DcJVKxm1LkYQ7Ukny8t-ThxcV8k",
    authDomain: "malwaregame-777.firebaseapp.com",
    projectId: "malwaregame-777",
    storageBucket: "malwaregame-777.appspot.com",
    messagingSenderId: "584958029606",
    appId: "1:584958029606:web:701168c7ce4be3f1df1be7",
    measurementId: "G-WHPETJHDLX",
    // --- IMPORTANT: databaseURL must match your Realtime DB URL ---
    // If console gave you a different URL, replace the line below with that value.
    databaseURL: "https://malwaregame-777-default-rtdb.firebaseio.com"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Push a score to /scores (used by game.js)
  window.sendScore = async function(name, score){
    try {
      const node = ref(db, 'scores');
      const newRef = push(node);
      await set(newRef, { name, score, ts: serverTimestamp() });
      console.log('score sent', name, score);
      return true;
    } catch (e) {
      console.error('sendScore failed', e);
      return false;
    }
  };
</script>

    <script src="game.js"></script>
  </body>
</html>

